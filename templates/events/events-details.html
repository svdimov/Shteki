{% extends 'base.html' %}
{% load static %}
{% block content %}
    <link rel="stylesheet" href="{% static 'css/events-details.css' %}" media="screen">
    <section class="u-align-center u-clearfix u-image u-shading u-section-1" id="carousel_790c" data-image-width="1980"
             data-image-height="1243">
        <div class="u-clearfix u-sheet u-valign-middle-lg u-sheet-1">
            <a href="" class="u-btn u-button-style u-hover-palette-1-dark-1 u-palette-1-base u-btn-1">edit event </a>
            <a href="" class="u-btn u-button-style u-hover-palette-1-dark-1 u-palette-1-base u-btn-2">delete event </a>
            <div class="u-form u-form-1">
                <form id="status-form" class="u-clearfix u-form-horizontal u-form-spacing-10 u-inner-form"
                      style="padding: 10px;">
                    <div class="u-form-email u-form-group">
                        <label for="status-input" class="u-label u-text-color-var u-label-1">Status</label>
                        <select id="status-input" name="status" class="u-input u-input-rectangle u-radius u-input-1">
                            <option value="Will go">Will go</option>
                            <option value="Maybe">Maybe</option>
                            <option value="Not going">Not going</option>
                        </select>
                    </div>
                    <div class="u-align-left u-form-group u-form-submit">
                        <button type="button" id="status-save-btn" class="u-btn u-btn-submit u-button-style">Save
                        </button>
                    </div>
                </form>

            </div>
            <h3 class="u-text u-text-default u-text-palette-2-base u-text-1">{{ event.name }}</h3>
            <div class="custom-expanded u-align-center u-container-align-center u-container-style u-group u-radius u-shape-round u-group-1">
                <div class="u-container-layout u-container-layout-1">
                    <div class="u-container-style u-expanded-width u-group u-radius u-shape-round u-group-2">
                        <div class="u-container-layout u-container-layout-2">
                            <p class="u-text u-text-default u-text-2">{{ will_go_count }} people will go: </p>
                            <div class="u-container-style u-group u-shape-rectangle u-group-3">
                                <div class="u-container-layout u-container-layout-3">

                                    {% for profile in participants %}
                                        <div class="u-container-style u-group u-image u-preserve-proportions u-shape-circle"
                                             title="{{ profile.full_name }}"
                                             style="background-image: url('{{ profile.profile_picture_or_default }}'); background-size: cover; width: 53px; height: 53px; display: inline-block; margin: 4px;">
                                            <div class="u-container-layout"></div>
                                        </div>
                                    {% empty %}
                                        <p>No participants yet.</p>
                                    {% endfor %}

                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="u-border-2 u-border-palette-1-base u-container-style u-group u-radius u-shape-round u-group-20">
                <div class="u-container-layout u-valign-top u-container-layout-20">
                    <div class="fr-view u-clearfix u-rich-text u-text u-text-3">
                        <p style="text-align: center;">DESCRIPTIONS</p>
                        <p style="text-align: center;">
                            <br>
                        </p>
                    </div>
                </div>
            </div>
            <div class="u-border-3 u-border-palette-1-base u-container-style u-group u-group-21">
                <div class="u-container-layout u-container-layout-21">
                    <div class="u-expanded-width u-gallery u-layout-grid u-lightbox u-show-text-on-hover u-gallery-1">
                        <div class="u-gallery-inner u-gallery-inner-1">
                            <div class="u-effect-fade u-gallery-item u-gallery-item-1">
                                <div class="u-back-slide" data-image-width="656" data-image-height="656">
                                    <img class="u-back-image u-expanded" src="{{ event.image1_url }}">
                                </div>
                                <div class="u-over-slide u-shading u-over-slide-1"></div>
                            </div>
                            <div class="u-effect-fade u-gallery-item u-gallery-item-2">
                                <div class="u-back-slide" data-image-width="1980" data-image-height="1320">
                                    <img class="u-back-image u-expanded"
                                         src="{{ event.image2_url }}">
                                </div>
                                <div class="u-over-slide u-shading u-over-slide-2"></div>
                            </div>
                            <div class="u-effect-fade u-gallery-item u-gallery-item-3">
                                <div class="u-back-slide" data-image-width="888" data-image-height="888">
                                    <img class="u-back-image u-expanded" src="{{ event.image3_url }}">
                                </div>
                                <div class="u-over-slide u-shading u-over-slide-3"></div>
                            </div>
                        </div>
                    </div>
                    <div class="u-expanded-width u-grey-light-2 u-map u-map-1">
                        <div class="embed-responsive">
                            <iframe class="embed-responsive-item"
                                    src="{{ event.location_url }}"
                                    data-map="JTdCJTIyYWRkcmVzcyUyMiUzQSUyMk1hbmhhdHRhbiUyQyUyME5ldyUyMFlvcmslMjIlMkMlMjJ6b29tJTIyJTNBMTAlMkMlMjJ0eXBlSWQlMjIlM0ElMjJyb2FkJTIyJTJDJTIybGFuZyUyMiUzQW51bGwlMkMlMjJhcGlLZXklMjIlM0FudWxsJTJDJTIybWFya2VycyUyMiUzQSU1QiU1RCU3RA=="></iframe>
                        </div>
                    </div>
                    <p class="u-text u-text-default u-text-4">Location name , city </p>
                    <p class="u-text u-text-default u-text-5">4 likes </p><span class="u-icon u-icon-1"><svg
                        class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 50 50" style=""><use
                        xlink:href="#svg-6915"></use></svg><svg class="u-svg-content" viewBox="0 0 50 50" x="0px"
                                                                y="0px" id="svg-6915"
                                                                style="enable-background:new 0 0 50 50;"><path
                        style="fill:currentColor;" d="M24.85,10.126c2.018-4.783,6.628-8.125,11.99-8.125c7.223,0,12.425,6.179,13.079,13.543
	c0,0,0.353,1.828-0.424,5.119c-1.058,4.482-3.545,8.464-6.898,11.503L24.85,48L7.402,32.165c-3.353-3.038-5.84-7.021-6.898-11.503
	c-0.777-3.291-0.424-5.119-0.424-5.119C0.734,8.179,5.936,2,13.159,2C18.522,2,22.832,5.343,24.85,10.126z"></path></svg></span>
                    <h5 class="u-text u-text-default u-text-6">Post Name</h5>
                    <p class="u-text u-text-default u-text-7">date and time post</p>
                    <div class="u-form u-form-2">
                        <form action="https://forms.nicepagesrv.com/v2/form/process"
                              class="u-clearfix u-form-horizontal u-form-spacing-10 u-inner-form" source="email"
                              name="form" style="padding: 10px;">
                            <div class="u-form-email u-form-group u-label-none">
                                <label for="email-6033" class="u-label">Email</label>
                                <input type="email" placeholder="Add a comment" id="email-6033" name="detail-event"
                                       class="u-border-palette-1-light-3 u-input u-input-rectangle u-none u-text-body-alt-color"
                                       required="">
                            </div>
                            <div class="u-align-left u-form-group u-form-submit u-label-none">
                                <a href="#" class="u-btn u-btn-submit u-button-style">Post</a>
                                <input type="submit" value="submit" class="u-form-control-hidden">
                            </div>
                            <div class="u-form-send-message u-form-send-success"> Thank you! Your message has been
                                sent.
                            </div>
                            <div class="u-form-send-error u-form-send-message"> Unable to send your message. Please fix
                                errors then try again.
                            </div>
                            <input type="hidden" value="" name="recaptchaResponse">
                            <input type="hidden" name="formServices" value="3474b205-8b3f-ad1c-9978-94b908b4a057">
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        document.getElementById('status-save-btn').addEventListener('click', function (e) {
            e.preventDefault();

            const statusValue = document.getElementById('status-input').value;
            const eventId = {{ event.id }};
            const csrfToken = '{{ csrf_token }}';

            fetch(`/api/events/${eventId}/status/`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': csrfToken
                },
                body: JSON.stringify({status: statusValue})
            })
                .then(response => {
                    if (response.ok) {
                        alert("Status saved successfully!");
                    } else {
                        alert("Failed to save status.");
                    }
                })
                .catch(err => {
                    alert("Error communicating with server.");
                });
        });
    </script>

{% endblock %}